<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang xml:lang>
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="Mono Wireless Inc." />
  <title>STG_STD</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <style type="text/css">body { line-height: 1.3em; }
p { line-height: 1.5em; }
img {
display: block;
margin-left: auto;
margin-right: auto;
width: 66%;
}
h1, h2, h3 {
padding: 1em 1em; border-left: 0.5em solid #000;
background: #f4f4f4;
}
h1.title {
all: initial;
font-size: 1em;
border-left: 3em solid #000;
padding: 0em 0.5em 0em 0.5em;
font-weight: bold;
}
p.author, h2.author {
all: initial;
font-size: 1em;
border-left: 0.5em solid #000;
padding: 0em 0.5em 0em 0.5em;
font-weight: bold;
}
p.date, h3.date {
all: initial;
font-size: 1em;
border-left: 0.5em solid #000;
border-right: 10em solid #000;
padding: 0em 0.5em 0em 0.5em;
font-weight: bold;
}
p.caption {
text-align: center;
font-weight: bold;
}
table {
width: 85%;
margin: auto;
border-collapse: collapse;
border-spacing: 4px;
}
pre {
width: 85%;
padding: 0.5em 1em;
margin: auto;
border:1px solid #333;
padding: 4px;
}
td, th {
border-collapse: collapse;
border:1px solid #333;
}
div.success {
width: 90%;
margin: 0.5em 1em;
margin-left: auto;
margin-right: auto;
padding: 0.5em 1em;
border: dashed 2px #408040;
background-color: #e0FFe0;
}
div.warning {
width: 90%;
margin: 0.5em 1em;
margin-left: auto;
margin-right: auto;
padding: 0.5em 1em;
border: dashed 2px #807060;
background-color: #FFF8E8;
}
div.danger {
width: 90%;
margin: 0.5em 1em;
margin-left: auto;
margin-right: auto;
padding: 0.5em 1em;
border: dashed 2px #FF0000;
background-color: #FFE0E0;
}
div.info {
width: 90%;
margin: 0.5em 1em;
margin-left: auto;
margin-right: auto;
padding: 0.5em 1em;
border: dashed 2px #404080;
background-color: #e8e8FF;
}
div.pageref {
padding: 0.5em 1em;
margin: 2em 0;
color: #232323;
background: #fff8e8;
border-left: solid 10px #ffc06e;
}
code {

padding: 0.2em 0.2em 0.2em 0.2em; background: #f0f0f0;
border: solid 1px #808080;
border-radius: 0.2em;
}
pre code {
background: #ffffff;
border: none;
}</style>
</head>
<body>
<header id="title-block-header">
<h1 class="title">STG_STD</h1>
<p class="author">Mono Wireless Inc.</p>
</header>
<nav id="TOC">
<ul>
<li><a href="#stg_std">&lt;STG_STD&gt;</a><ul>
<li><a href="#使用法">使用法</a><ul>
<li><a href="#登録">登録</a></li>
<li><a href="#setup-での読み出し">setup() での読み出し</a></li>
</ul></li>
<li><a href="#設定一覧">設定一覧</a></li>
<li><a href="#設定ビヘイビアのカスタマイズ">設定ビヘイビアのカスタマイズ</a><ul>
<li><a href="#アプリケーション名">アプリケーション名</a></li>
<li><a href="#デフォルト値">デフォルト値</a></li>
<li><a href="#複数チャネル設定メニュー">複数チャネル設定メニュー</a></li>
<li><a href="#すぐに設定画面を表示する">すぐに設定画面を表示する</a></li>
<li><a href="#項目名詳細の記述内容の変更">項目名、詳細の記述内容の変更</a></li>
<li><a href="#現在設定画面かどうか判定">現在設定画面かどうか判定</a></li>
<li><a href="#項目の削除">項目の削除</a></li>
</ul></li>
<li><a href="#メソッド">メソッド</a><ul>
<li><a href="#reload">reload()</a></li>
</ul></li>
<li><a href="#メソッド-データ読み出し">メソッド （データ読み出し）</a><ul>
<li><a href="#設定の反映">設定の反映</a></li>
</ul></li>
<li><a href="#項目id">項目ID</a></li>
<li><a href="#extra-menu">Extra Menu</a><ul>
<li><a href="#eeprom-util">EEPROM UTIL</a></li>
<li><a href="#hw-util">H/W UTIL</a></li>
</ul></li>
</ul></li>
</ul>
</nav>
<h1 id="stg_std">&lt;STG_STD&gt;</h1>
<p>&lt;STG_STD&gt; は、最小限の設定項目を有した設定ビヘイビアです。</p>
<pre><code>　　　　　　　　　　　　　　　設定画面例
[CONFIG/MY_APP:0/SID=8102ECE3]
a: (0x1234ABCD) Application ID [HEX:32bit]
i: (         1) Device ID [1-100,etc]
c: (        13) Channel [11-26]
o: (0x00000000) Option Bits [HEX:32bit]

 [ESC]:Back [!]:Reset System [M]:Extr Menu                      </code></pre>
<div class="info">
<p>このビヘイビアはSerialオブジェクトの入出力をフックし、インタラクティブモードでの画面入出力を行います。アプリケーション中で入力処理を明示的に記述する必要はありません。インタラクティブモード画面中のアプリケーションからの画面出力は抑制されます。</p>
</div>
<div class="info">
<p>M キーを入力すると、補助機能にアクセスできます。機能は末尾の Extra Menu 項目を参照ください。</p>
</div>
<h2 id="使用法">使用法</h2>
<h3 id="登録">登録</h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode cpp"><code class="sourceCode cpp"><a class="sourceLine" id="cb2-1" title="1"><span class="co">// use twelite mwx c++ template library</span></a>
<a class="sourceLine" id="cb2-2" title="2"><span class="pp">#include </span><span class="im">&lt;TWELITE&gt;</span></a>
<a class="sourceLine" id="cb2-3" title="3"><span class="pp">#include </span><span class="im">&lt;NWK_SIMPLE&gt;</span></a>
<a class="sourceLine" id="cb2-4" title="4"><span class="pp">#include </span><span class="im">&lt;STG_STD&gt;</span><span class="pp"> </span><span class="co">// interactive mode</span></a></code></pre></div>
<p>上記のように <code>#include &lt;STG_STD&gt;</code>を追加します。</p>
<h3 id="setup-での読み出し">setup() での読み出し</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode cpp"><code class="sourceCode cpp"><a class="sourceLine" id="cb3-1" title="1"><span class="dt">uint32_t</span> APP_ID;</a>
<a class="sourceLine" id="cb3-2" title="2"><span class="dt">uint8_t</span> CHANNEL;</a>
<a class="sourceLine" id="cb3-3" title="3"><span class="dt">uint8_t</span> LID;</a>
<a class="sourceLine" id="cb3-4" title="4"></a>
<a class="sourceLine" id="cb3-5" title="5"><span class="dt">void</span> setup() {</a>
<a class="sourceLine" id="cb3-6" title="6">   ...</a>
<a class="sourceLine" id="cb3-7" title="7">   <span class="kw">auto</span>&amp;&amp; set = the_twelite.settings.use&lt;STG_STD&gt;();</a>
<a class="sourceLine" id="cb3-8" title="8"></a>
<a class="sourceLine" id="cb3-9" title="9">   <span class="co">// call reload() before reading values.   </span></a>
<a class="sourceLine" id="cb3-10" title="10">   set.reload();</a>
<a class="sourceLine" id="cb3-11" title="11">   </a>
<a class="sourceLine" id="cb3-12" title="12">   <span class="co">// read value</span></a>
<a class="sourceLine" id="cb3-13" title="13">   APP_ID = set.u32appid();</a>
<a class="sourceLine" id="cb3-14" title="14">   CHANNEL = set.u8ch();</a>
<a class="sourceLine" id="cb3-15" title="15">   LID = set.u8devid();</a>
<a class="sourceLine" id="cb3-16" title="16">   </a>
<a class="sourceLine" id="cb3-17" title="17">   <span class="co">// apply them</span></a>
<a class="sourceLine" id="cb3-18" title="18">     the_twelite</a>
<a class="sourceLine" id="cb3-19" title="19">        &lt;&lt; TWENET::appid(APP_ID)</a>
<a class="sourceLine" id="cb3-20" title="20">        &lt;&lt; TWENET::channel(CHANNEL);</a>
<a class="sourceLine" id="cb3-21" title="21">        </a>
<a class="sourceLine" id="cb3-22" title="22">   <span class="kw">auto</span>&amp;&amp; nwk = the_twelite.network.use&lt;NWK_SIMPLE&gt;();</a>
<a class="sourceLine" id="cb3-23" title="23">   nwk  &lt;&lt; NWK_SIMPLE::logical_id(LID);</a>
<a class="sourceLine" id="cb3-24" title="24">}</a></code></pre></div>
<p>多くの場合、設定の読み出しは<code>setup()</code> 中の早い段階で行います。</p>
<p>上記の例はでは、まず<code>the_twelite.settings.use&lt;STG_STD&gt;()</code>により設定ビヘイビアを登録します。</p>
<div class="info">
<p>登録直後に、デフォルトのアプリケーションIDを変更するなど設定ビヘイビアの変更を行うことができますが、これは後述します。</p>
</div>
<p>つぎに<code>set.reload()</code>を呼び出し、実際にEEPROMからデータを読み出し、これを解釈します。自動で読み出さないことに注意してください。</p>
<p><code>set.u32appid()</code>, <code>set.u8ch()</code>, <code>set.u8devid()</code>は各々アプリケーションIDの設定値、チャネルの設定値、論理デバイスIDの設定値を取得しています。ここでは変数に各設定値を格納しています。</p>
<div class="info">
<p>設定値を格納した内部データ構造は比較的複雑であるため、求める設定を得るまで、設計配列のデータ探索が必要になります。計算量を気にする場合は一旦設定値を別の変数に格納するようにしてください。</p>
</div>
<p>あとは、設定値を利用してアプリケーションIDやチャネルなどの値を反映します。</p>
<h2 id="設定一覧">設定一覧</h2>
<p>以下が設定IDの一覧(<code>enum class E_STGSTD_SETID</code>)定義です。</p>
<table>
<thead>
<tr class="header">
<th>設定ID</th>
<th>内容</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>APPID</code></td>
<td>アプリケーションID</td>
</tr>
<tr class="even">
<td><code>LOGICALID</code></td>
<td>論理デバイスID (8bit)</td>
</tr>
<tr class="odd">
<td><code>CHANNEL</code></td>
<td>チャネル</td>
</tr>
<tr class="even">
<td><code>CHANNELS_3</code></td>
<td>チャネル（３ｃｈまで）</td>
</tr>
<tr class="odd">
<td><code>POWER_N_RETRY</code></td>
<td>出力とリトライ回数</td>
</tr>
<tr class="even">
<td><code>OPTBITS</code></td>
<td>Option 1</td>
</tr>
<tr class="odd">
<td><code>OPT_DWORD2</code></td>
<td>Option 2</td>
</tr>
<tr class="even">
<td><code>OPT_DWORD3</code></td>
<td>Option 3</td>
</tr>
<tr class="odd">
<td><code>OPT_DWORD4</code></td>
<td>Option 4</td>
</tr>
<tr class="even">
<td><code>ENC_MODE</code></td>
<td>暗号化モード</td>
</tr>
<tr class="odd">
<td><code>ENC_KEY_STRING</code></td>
<td>暗号化キー（文字列入力）</td>
</tr>
</tbody>
</table>
<p><code>&lt;STG_STD&gt;</code>では、代表的な設定と自由に使える32bit値を４つ定義されています。これらは、ユーザが自由に利用できます。</p>
<div class="info">
<ul>
<li>STG_STD&gt;から読み出すだけでは設定は反映されません。</li>
<li>不要な項目を非表示にできます。</li>
<li>項目名や項目詳細を変更できます。</li>
</ul>
</div>
<h2 id="設定ビヘイビアのカスタマイズ">設定ビヘイビアのカスタマイズ</h2>
<p>設定ビヘイビアのカスタマイズは<code>.reload()</code>を行う前に全項目を行っておきます。</p>
<h3 id="アプリケーション名">アプリケーション名</h3>
<div class="sourceCode" id="cb4"><pre class="sourceCode cpp"><code class="sourceCode cpp"><a class="sourceLine" id="cb4-1" title="1">    <span class="kw">auto</span>&amp;&amp; set = the_twelite.settings.use&lt;STG_STD&gt;();</a>
<a class="sourceLine" id="cb4-2" title="2">    set &lt;&lt; SETTINGS::appname(<span class="st">&quot;MY_APP&quot;</span>);</a>
<a class="sourceLine" id="cb4-3" title="3">    ...</a>
<a class="sourceLine" id="cb4-4" title="4">    set.reload();</a></code></pre></div>
<p>アプリケーション名はインタラクティブモードの先頭行に表示されます。</p>
<pre><code>[CONFIG/MY_APP:0/SID=8102ECE3]</code></pre>
<p>文字列ポインタを指定してください。内部でコピーを作らないようにしているため、ローカル変数を指定できません。</p>
<h3 id="デフォルト値">デフォルト値</h3>
<div class="sourceCode" id="cb6"><pre class="sourceCode cpp"><code class="sourceCode cpp"><a class="sourceLine" id="cb6-1" title="1">    <span class="kw">auto</span>&amp;&amp; set = the_twelite.settings.use&lt;STG_STD&gt;();</a>
<a class="sourceLine" id="cb6-2" title="2">    set &lt;&lt; SETTINGS::appid_default(<span class="bn">0x13579be</span>);</a>
<a class="sourceLine" id="cb6-3" title="3">    set &lt;&lt; SETTINGS::ch_default(<span class="dv">18</span>);</a>
<a class="sourceLine" id="cb6-4" title="4">    set &lt;&lt; SETTINGS::lid_default(<span class="dv">7</span>);</a>
<a class="sourceLine" id="cb6-5" title="5">        ...</a>
<a class="sourceLine" id="cb6-6" title="6">    set.reload();</a></code></pre></div>
<p>アプリケーションID、チャネル、論理ID(LID)については、デフォルト値を変更できます。</p>
<h3 id="複数チャネル設定メニュー">複数チャネル設定メニュー</h3>
<div class="sourceCode" id="cb7"><pre class="sourceCode cpp"><code class="sourceCode cpp"><a class="sourceLine" id="cb7-1" title="1">    <span class="kw">auto</span>&amp;&amp; set = the_twelite.settings.use&lt;STG_STD&gt;();</a>
<a class="sourceLine" id="cb7-2" title="2">    set &lt;&lt; SETTINGS::ch_multi();</a>
<a class="sourceLine" id="cb7-3" title="3">    ...</a>
<a class="sourceLine" id="cb7-4" title="4">    set.reload();</a></code></pre></div>
<p><code>SETTINGS::ch_multi()</code>を指定すると、チャネル設定が複数指定になります。複数設定を行う場合、設定値の読み出しは<code>.u32chmask()</code>を用います。</p>
<h3 id="すぐに設定画面を表示する">すぐに設定画面を表示する</h3>
<div class="sourceCode" id="cb8"><pre class="sourceCode cpp"><code class="sourceCode cpp"><a class="sourceLine" id="cb8-1" title="1"><span class="kw">auto</span>&amp;&amp; set = the_twelite.settings.use&lt;STG_STD&gt;();</a>
<a class="sourceLine" id="cb8-2" title="2">    set &lt;&lt; SETTINGS::open_at_start();</a>
<a class="sourceLine" id="cb8-3" title="3">    ...</a>
<a class="sourceLine" id="cb8-4" title="4">    set.reload();</a></code></pre></div>
<p>アプリケーションID、チャネル、論理IDについては、デフォルト値を変更できます。</p>
<h3 id="項目名詳細の記述内容の変更">項目名、詳細の記述内容の変更</h3>
<div class="sourceCode" id="cb9"><pre class="sourceCode cpp"><code class="sourceCode cpp"><a class="sourceLine" id="cb9-1" title="1"><span class="at">const</span> TWESTG_tsMsgReplace SET_MSGS[] = {</a>
<a class="sourceLine" id="cb9-2" title="2">    { <span class="dt">int</span>(E_STGSTD_SETID::OPTBITS),    <span class="st">&quot;オプション1&quot;</span>, </a>
<a class="sourceLine" id="cb9-3" title="3">            <span class="st">&quot;オプション１を設定してください&quot;</span> },</a>
<a class="sourceLine" id="cb9-4" title="4">    { <span class="dt">int</span>(E_STGSTD_SETID::OPT_DWORD2), <span class="st">&quot;オプション2&quot;</span>,</a>
<a class="sourceLine" id="cb9-5" title="5">            <span class="st">&quot;オプション２を設定してください</span><span class="sc">\r\n</span><span class="st">オプション２は云々&quot;</span> },</a>
<a class="sourceLine" id="cb9-6" title="6">    { <span class="bn">0xFF</span> } <span class="co">// terminator</span></a>
<a class="sourceLine" id="cb9-7" title="7">};</a>
<a class="sourceLine" id="cb9-8" title="8"></a>
<a class="sourceLine" id="cb9-9" title="9">setup() {</a>
<a class="sourceLine" id="cb9-10" title="10">  <span class="kw">auto</span>&amp;&amp; set = the_twelite.settings.use&lt;STG_STD&gt;();</a>
<a class="sourceLine" id="cb9-11" title="11">    set.replace_item_name_desc(SET_MSGS);</a>
<a class="sourceLine" id="cb9-12" title="12">    ...</a></code></pre></div>
<p>項目名を別のモノに変更することが出来ます。上記の例ではUTF-8による日本語にしていますが、ターミナルの表示など条件がそろわないと適切には表示されません。</p>
<div class="info">
<p>TWELITE STAGEの場合、登録フォントの文字数を減らしている場合は、表示されない文字が出てくるかもしれません。必要な文字列が含まれるよう、再ビルドしてください。</p>
</div>
<p>この配列は最後に <code>{ 0xFF }</code> で終端します。</p>
<p>１番目のエントリは設定ID、２番目が項目名、３番目が設定入力時に表示される解説になります。<code>\r\n</code>により改行できます。</p>
<h3 id="現在設定画面かどうか判定">現在設定画面かどうか判定</h3>
<div class="sourceCode" id="cb10"><pre class="sourceCode cpp"><code class="sourceCode cpp"><a class="sourceLine" id="cb10-1" title="1">        <span class="kw">auto</span>&amp;&amp; set = the_twelite.settings.use&lt;STG_STD&gt;();</a>
<a class="sourceLine" id="cb10-2" title="2">        <span class="cf">if</span> (!set.is_screen_opened()) {</a>
<a class="sourceLine" id="cb10-3" title="3">           <span class="co">// 設定画面が出ていないときの処理</span></a>
<a class="sourceLine" id="cb10-4" title="4">        }</a></code></pre></div>
<p>設定画面出力中にシリアルへの出力を行うと画面が崩れたりする原因になります。設定画面でないことを確認するには<code>.is_screen_opened()</code>で確認します。</p>
<h3 id="項目の削除">項目の削除</h3>
<div class="sourceCode" id="cb11"><pre class="sourceCode cpp"><code class="sourceCode cpp"><a class="sourceLine" id="cb11-1" title="1"><span class="kw">auto</span>&amp;&amp; set = the_twelite.settings.use&lt;STG_STD&gt;();</a>
<a class="sourceLine" id="cb11-2" title="2">set.hide_items(E_STGSTD_SETID::OPT_DWORD3, E_STGSTD_SETID::OPT_DWORD4);</a>
<a class="sourceLine" id="cb11-3" title="3"></a>
<a class="sourceLine" id="cb11-4" title="4">...</a>
<a class="sourceLine" id="cb11-5" title="5"><span class="cf">if</span>(set.is_hidden(E_STGSTD_SETID::OPT_DWORD3) {</a>
<a class="sourceLine" id="cb11-6" title="6">  ; <span class="co">// OPT_DWORD3は非表示</span></a>
<a class="sourceLine" id="cb11-7" title="7">}</a></code></pre></div>
<p>不要な項目の削除を行います。<code>.hide_items</code>は項目IDをパラメータとして（可変引数で複数指定可能）不要な項目を非表示にします。非表示項目かどうかは<code>.is_hidden()</code>により確認できます。</p>
<div class="warning">
<p>アプリケーションID,チャネル,論理ID(LID)の３種類は削除できません。</p>
</div>
<div class="warning">
<p>非表示設定は内部のワークメモリを使用します。最小限のメモリ容量(32バイト)としているため、非表示項目を多数設定する場合、メモリ不足で非表示にならない場合があります。ワークメモリの容量はコンパイル引数として<code>-DSIZE_SETSTD_CUST_COMMON=48</code>のように指定できます。</p>
</div>
<h2 id="メソッド">メソッド</h2>
<h3 id="reload">reload()</h3>
<div class="sourceCode" id="cb12"><pre class="sourceCode cpp"><code class="sourceCode cpp"><a class="sourceLine" id="cb12-1" title="1">    <span class="kw">auto</span>&amp;&amp; set = the_twelite.settings.use&lt;STG_STD&gt;();</a>
<a class="sourceLine" id="cb12-2" title="2">    set &lt;&lt; SETTINGS::appname(APP_NAME)</a>
<a class="sourceLine" id="cb12-3" title="3">          &lt;&lt; SETTINGS::appid_default(DEF_APP_ID)</a>
<a class="sourceLine" id="cb12-4" title="4">        &lt;&lt; SETTINGS::open_at_start();</a>
<a class="sourceLine" id="cb12-5" title="5">   </a>
<a class="sourceLine" id="cb12-6" title="6">    set.reload();</a></code></pre></div>
<p>設定を読み込みます。すべてのカスタマイズが終わってから実行します。</p>
<h2 id="メソッド-データ読み出し">メソッド （データ読み出し）</h2>
<p>データの読み出しは以下のメソッドを呼び出します。</p>
<div class="warning">
<p>読み出し前に必ず<code>.reload()</code>を呼び出してください。</p>
</div>
<table>
<thead>
<tr class="header">
<th>メソッド</th>
<th>内容</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>uint32_t u32appid()</code></td>
<td>アプリケーションID</td>
</tr>
<tr class="even">
<td><code>uint8_t u8devid()</code></td>
<td>論理デバイスID</td>
</tr>
<tr class="odd">
<td><code>uint8_t u8ch()</code></td>
<td>設定チャネル (11..26)</td>
</tr>
<tr class="even">
<td><code>uint32_t u32chmask()</code></td>
<td>チャネル設定マスク (ビットマスクで指定、13 なら 1UL &lt;&lt; 13 にビットを設定する)</td>
</tr>
<tr class="odd">
<td><code>uint8_t u8power()</code></td>
<td>出力設定 (0..3)</td>
</tr>
<tr class="even">
<td><code>uint8_t u8retry()</code></td>
<td>リトライ数</td>
</tr>
<tr class="odd">
<td><code>uint32_t u32opt1()</code></td>
<td>オプション1</td>
</tr>
<tr class="even">
<td><code>uint32_t u32opt2()</code></td>
<td>オプション2</td>
</tr>
<tr class="odd">
<td><code>uint32_t u32opt3()</code></td>
<td>オプション3</td>
</tr>
<tr class="even">
<td><code>uint32_t u32opt4()</code></td>
<td>オプション4</td>
</tr>
<tr class="odd">
<td><code>uint8_t u8encmode()</code></td>
<td>暗号化モード (0: なし 1: 有効 2: 有効、平文パケットも表示する)</td>
</tr>
<tr class="even">
<td><code>const uint8_t * u8enckeystr()</code></td>
<td>暗号化キーの取得</td>
</tr>
</tbody>
</table>
<div class="info">
<p>内部では、構造体配列を線形探索して設定IDに合致する設定構造体を探索しており、オーバーヘッドがあります。頻繁に参照される設定値は一旦別の変数にコピーして使用してください。</p>
</div>
<h3 id="設定の反映">設定の反映</h3>
<p><code>the_twelite</code>や<code>&lt;NWK_SIMPLE&gt;</code>オブジェクトに対して、本オブジェクトを用いて直接設定を反映できます。</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode cpp"><code class="sourceCode cpp"><a class="sourceLine" id="cb13-1" title="1"><span class="kw">auto</span>&amp;&amp; set = the_twelite.settings.use&lt;STG_STD&gt;();</a>
<a class="sourceLine" id="cb13-2" title="2">...</a>
<a class="sourceLine" id="cb13-3" title="3">set.reload(); <span class="co">//ここで実際に設定がEEPROMより読み出される</span></a>
<a class="sourceLine" id="cb13-4" title="4"></a>
<a class="sourceLine" id="cb13-5" title="5">the_twelite &lt;&lt; set; <span class="co">// 設定値の反映 (APPIDなど)</span></a>
<a class="sourceLine" id="cb13-6" title="6"></a>
<a class="sourceLine" id="cb13-7" title="7"><span class="kw">auto</span>&amp;&amp; nwk = the_twelite.network.use&lt;NWK_SIMPLE&gt;();</a>
<a class="sourceLine" id="cb13-8" title="8"></a>
<a class="sourceLine" id="cb13-9" title="9">nwk &lt;&lt; set; <span class="co">// 設定値の反映 (LIDなど)</span></a></code></pre></div>
<p>反映される設定値は以下となります。<code>.hide_items()</code>により非表示になっている項目は反映しません。</p>
<table>
<colgroup>
<col style="width: 7%"></col>
<col style="width: 8%"></col>
<col style="width: 83%"></col>
</colgroup>
<thead>
<tr class="header">
<th>対象</th>
<th>項目ID</th>
<th>内容</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>the_twelite</code></td>
<td><code>APPID</code></td>
<td><code>TWENET::appid(値)</code>に反映されます。</td>
</tr>
<tr class="even">
<td></td>
<td><code>CHANNEL</code></td>
<td><code>TWENET::channel(値)</code>に反映されます。<code>※ SETTINGS::ch_multi()</code>を指定したときは反映されません</td>
</tr>
<tr class="odd">
<td></td>
<td><code>CHANNELS_3</code></td>
<td><code>TWENET::chmask(値)</code>による設定を行います。<code>※ SETTINGS::ch_multi()</code>を指定したときのみ、チャネルマスクとして反映されます。</td>
</tr>
<tr class="even">
<td></td>
<td><code>POWER_N_RETRY</code></td>
<td><code>TWENET::tx_power(値)</code>と<code>TWENET::mac_retry_count(値)</code>による設定を行います。注： <code>&amp;#x3C;NWK_SIMPLE&gt;</code>での再送設定も同じ値を参照します。</td>
</tr>
<tr class="odd">
<td><code>&lt;NWK_SIMPLE&gt;</code></td>
<td><code>LOGICALID</code></td>
<td><code>NWK_SIMPLE::logical_id(LID)</code>による設定を行います。</td>
</tr>
<tr class="even">
<td></td>
<td><code>POWER_N_RETRY</code></td>
<td><code>NWK_SIMPLE::repeat_max(LID)</code>による設定を行います。</td>
</tr>
</tbody>
</table>
<h2 id="項目id">項目ID</h2>
<p><code>.hide_items()</code>などで項目IDを指定する場合があります。この項目IDは<code>enum class E_STGSTD_SETID</code>で定義されてます。</p>
<table>
<thead>
<tr class="header">
<th>E_STGSTD_SETID::</th>
<th>内容</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>APPID</code></td>
<td>アプリケーションID</td>
</tr>
<tr class="even">
<td><code>LOGICALID</code></td>
<td>論理ID(0..100)</td>
</tr>
<tr class="odd">
<td><code>CHANNEL</code></td>
<td>チャネル</td>
</tr>
<tr class="even">
<td><code>CHANNELS_3</code></td>
<td>チャネル（複数指定）</td>
</tr>
<tr class="odd">
<td><code>POWER_N_RETRY</code></td>
<td>出力とリトライ設定</td>
</tr>
<tr class="even">
<td><code>OPTBITS</code></td>
<td>オプションビット</td>
</tr>
<tr class="odd">
<td><code>UARTBAUD</code></td>
<td>UARTのボーレート設定</td>
</tr>
<tr class="even">
<td><code>OPT_DWORD2</code></td>
<td>オプションビット２</td>
</tr>
<tr class="odd">
<td><code>OPT_DWORD3</code></td>
<td>オプションビット３</td>
</tr>
<tr class="even">
<td><code>OPT_DWORD4</code></td>
<td>オプションビット４</td>
</tr>
<tr class="odd">
<td><code>ENC_MODE</code></td>
<td>暗号化モード</td>
</tr>
<tr class="even">
<td><code>ENC_KEY_STRING</code></td>
<td>暗号化キー</td>
</tr>
</tbody>
</table>
<h2 id="extra-menu">Extra Menu</h2>
<pre><code>[ROOT MENU/BAT1/SID=810B645E]
0: CONFIG
1: EEPROM UTIL
2: H/W UTIL

 [ESC]:Back [!]:Reset System                                    </code></pre>
<p>Mキーを入力すると追加メニューにアクセスできます。</p>
<ul>
<li>CONFIG : 設定画面に戻ります</li>
<li>EEPROM UTIL : EEPROMのメンテナンスを行うためのメニューです</li>
<li>H/W UTIL : ハードウェアの状態を調べるためのメニューです</li>
</ul>
<h3 id="eeprom-util">EEPROM UTIL</h3>
<pre><code>[EEPROM UTIL/BAT1/SID=810B645E]
r: Read sector.
R: Read ALL sectors.
e: Erase sector.
E: Erase ALL sectors.

 [ESC]:Back [!]:Reset System [M]:Extr Menu</code></pre>
<p>セクターの読み出し、削除を行います。全読み出し、全消去を行うときは大文字で “YES” の３文字を入力します。</p>
<h3 id="hw-util">H/W UTIL</h3>
<pre><code>[H/W UTIL/BAT1/SID=810B645E]                   </code></pre>
<p>現バージョンでは機能は提供されません。</p>
</body>
</html>
