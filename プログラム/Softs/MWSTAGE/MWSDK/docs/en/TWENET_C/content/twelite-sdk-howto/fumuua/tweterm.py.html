<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang xml:lang>
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Untitled</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <style type="text/css">body { line-height: 1.3em; }
p { line-height: 1.5em; }
img {
display: block;
margin-left: auto;
margin-right: auto;
width: 66%;
}
h1, h2, h3 {
padding: 1em 1em; border-left: 0.5em solid #000;
background: #f4f4f4;
}
h1.title {
all: initial;
font-size: 1em;
border-left: 3em solid #000;
padding: 0em 0.5em 0em 0.5em;
font-weight: bold;
}
p.author, h2.author {
all: initial;
font-size: 1em;
border-left: 0.5em solid #000;
padding: 0em 0.5em 0em 0.5em;
font-weight: bold;
}
p.date, h3.date {
all: initial;
font-size: 1em;
border-left: 0.5em solid #000;
border-right: 10em solid #000;
padding: 0em 0.5em 0em 0.5em;
font-weight: bold;
}
p.caption {
text-align: center;
font-weight: bold;
}
table {
width: 85%;
margin: auto;
border-collapse: collapse;
border-spacing: 4px;
}
pre {
width: 85%;
padding: 0.5em 1em;
margin: auto;
border:1px solid #333;
padding: 4px;
}
td, th {
border-collapse: collapse;
border:1px solid #333;
}
div.success {
width: 90%;
margin: 0.5em 1em;
margin-left: auto;
margin-right: auto;
padding: 0.5em 1em;
border: dashed 2px #408040;
background-color: #e0FFe0;
}
div.warning {
width: 90%;
margin: 0.5em 1em;
margin-left: auto;
margin-right: auto;
padding: 0.5em 1em;
border: dashed 2px #807060;
background-color: #FFF8E8;
}
div.danger {
width: 90%;
margin: 0.5em 1em;
margin-left: auto;
margin-right: auto;
padding: 0.5em 1em;
border: dashed 2px #FF0000;
background-color: #FFE0E0;
}
div.info {
width: 90%;
margin: 0.5em 1em;
margin-left: auto;
margin-right: auto;
padding: 0.5em 1em;
border: dashed 2px #404080;
background-color: #e8e8FF;
}
div.pageref {
padding: 0.5em 1em;
margin: 2em 0;
color: #232323;
background: #fff8e8;
border-left: solid 10px #ffc06e;
}
code {

padding: 0.2em 0.2em 0.2em 0.2em; background: #f0f0f0;
border: solid 1px #808080;
border-radius: 0.2em;
}
pre code {
background: #ffffff;
border: none;
}</style>
</head>
<body>
<nav id="TOC">
<ul>
<li><a href="#tweterm.py">tweterm.py</a><ul>
<li><a href="#warranty-and-license">Warranty and license</a></li>
<li><a href="#system-requirements-and-required-packages">System requirements and required packages</a><ul>
<li><a href="#reference-environment">reference environment</a></li>
</ul></li>
<li><a href="#installation">installation</a><ul>
<li><a href="#packages">packages</a></li>
<li><a href="#実行">実行</a></li>
</ul></li>
<li><a href="#usage">Usage</a><ul>
<li><a href="#unload-usb-driver">Unload USB driver</a></li>
<li><a href="#command-parameters">Command parameters</a></li>
<li><a href="#keyboard-operation">keyboard operation</a></li>
</ul></li>
<li><a href="#execution-example">[Execution example]</a></li>
</ul></li>
</ul>
</nav>
<h1 id="tweterm.py">tweterm.py</h1>
<p>This program incorporates the pyftdi (https://github.com/eblot/pyftdi) library sample script pyterm.py with a firmware write script for TWELITE. It has the following features</p>
<ul>
<li>Writing firmware for TWELITE (TWELITE R/MONOSTICK)</li>
<li>Checking the behaviour via the serial port</li>
</ul>
<div class="warning">
<p>This script requires the Python3 interpreter to run on OS X. It is intended for users who are familiar with the command line environment and the Python interpreter.</p>
</div>
<div class="warning">
<p>In order to make this script work on Linux, you will need the equivalent packages (libusb-dev, pyserial, pyftdi). It is intended for people who are familiar with the command line environment and the Python interpreter.</p>
<ul>
<li>reference environment：Ubuntu 16.04 (i386 32bit), Python3.5.2 / Ubuntu 18.04 (x86-64 64bit), Python 3.6.5</li>
</ul>
</div>
<h2 id="warranty-and-license">Warranty and license</h2>
<p>Anything in this package that is not specifically mentioned in the license is governed by the Mono Wireless Software License Agreement.</p>
<p>This software is not officially supported by Mono Wireless Inc. Please note that we may not be able to answer your enquiries. Please understand beforehand.</p>
<p>In response to reports of defects or other problems, Mono Wireless Inc. does not promise to fix or improve the product.</p>
<p>It may not work in all cases, depending on the package you have installed and your environment.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb1-1" title="1"><span class="co"># Copyright (C) 2017 Mono Wireless Inc. All Rights Reserved.</span></a>
<a class="sourceLine" id="cb1-2" title="2"><span class="co"># Released under MW-SLA-*J,*E (MONO WIRELESS SOFTWARE LICENSE</span></a>
<a class="sourceLine" id="cb1-3" title="3"><span class="co"># AGREEMENT)</span></a></code></pre></div>
<h2 id="system-requirements-and-required-packages">System requirements and required packages</h2>
<ul>
<li>Mac OS X or Linux</li>
<li>python3.5 or later</li>
<li>libusb</li>
<li>pyserial</li>
<li>pyftdi</li>
</ul>
<h3 id="reference-environment">reference environment</h3>
<p>We have developed and tested the software in the following environments. However, we do not guarantee that it will work in these environments.</p>
<table>
<thead>
<tr class="header">
<th>environment</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Mac OS X 10.11.6, Python3.5.1 (2018/05)</td>
</tr>
<tr class="even">
<td>Ubuntu 18.04, Python3.6.7 (2018/05)</td>
</tr>
<tr class="odd">
<td>Mac OS X 10.14.2, Python3.7.2 (2019/01)</td>
</tr>
</tbody>
</table>
<h2 id="installation">installation</h2>
<h3 id="packages">packages</h3>
<h4 id="macos">macOS</h4>
<p>Below is an example of installing all new packages using Homebrew.</p>
<h4 id="homebrew">Homebrew</h4>
<p>install Homebrew.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb2-1" title="1"><span class="ex">/usr/bin/ruby</span> -e <span class="st">&quot;</span><span class="va">$(</span><span class="ex">curl</span> -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install<span class="va">)</span><span class="st">&quot;</span></a></code></pre></div>
<h4 id="python3">Python3</h4>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb3-1" title="1">$ <span class="ex">brew</span> install python3</a></code></pre></div>
<h4 id="libusb">libusb</h4>
<div class="sourceCode" id="cb4"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb4-1" title="1">$ <span class="ex">brew</span> install libusb</a></code></pre></div>
<h4 id="pyserial">pyserial</h4>
<div class="sourceCode" id="cb5"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb5-1" title="1">$ <span class="ex">pip3</span> install pyserial</a></code></pre></div>
<h4 id="pyftdi">pyftdi</h4>
<div class="sourceCode" id="cb6"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb6-1" title="1">$ <span class="ex">pip3</span> install pyftdi</a></code></pre></div>
<h4 id="linux">Linux</h4>
<p>Please check your distribution’s package installation instructions. You will need the following packages.</p>
<ul>
<li>python3.5 or later (In many cases, it has been introduced)</li>
<li>libusb-dev</li>
<li>pyserial</li>
<li>pyftdi</li>
</ul>
<p>example for package installation.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb7-1" title="1">$ <span class="fu">sudo</span> apt-get install libusb-dev</a>
<a class="sourceLine" id="cb7-2" title="2">$ <span class="fu">sudo</span> apt-get install python3-pip</a>
<a class="sourceLine" id="cb7-3" title="3">$ <span class="ex">pip3</span> install pyserial</a>
<a class="sourceLine" id="cb7-4" title="4">$ <span class="ex">pip3</span> install pyftdi</a></code></pre></div>
<h3 id="実行">実行</h3>
<p>The folder where the TWELITE SDK was installed is described as <code>${TWELITESDK}</code>.</p>
<p>The script can be found below.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb8-1" title="1"><span class="va">${TWELITESDK}</span><span class="ex">/Tools/tweterm/tweterm.py</span></a></code></pre></div>
<p>Gives the script permission to run.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb9-1" title="1">$ <span class="fu">chmod</span> +x <span class="va">${TWELITESDK}</span>/Tools/tweterm/tweterm.py</a></code></pre></div>
<p>If necessary, add it to the PATH environment variable.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb10-1" title="1">$ <span class="va">PATH=${TWELITESDK}</span>/Tools/tweterm:<span class="va">$PATH</span></a></code></pre></div>
<h2 id="usage">Usage</h2>
<h3 id="unload-usb-driver">Unload USB driver</h3>
<div class="warning">
<p>Unload the driver as libusb conflicts with the OS driver.</p>
</div>
<h4 id="macos-1">macOS</h4>
<p>Unloads FTDI-related drivers.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb11-1" title="1">$ <span class="fu">sudo</span> kextunload -b com.apple.driver.AppleUSBFTDI</a></code></pre></div>
<h4 id="linux-1">Linux</h4>
<p>No need to unload the driver.</p>
<div class="warning">
<p>If you get an error, try unloading the driver.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb12-1" title="1">$ <span class="fu">sudo</span> rmmod ftdi_sio</a>
<a class="sourceLine" id="cb12-2" title="2">$ <span class="fu">sudo</span> rmmod usbserial</a></code></pre></div>
</div>
<h3 id="command-parameters">Command parameters</h3>
<table>
<thead>
<tr class="header">
<th>parameter</th>
<th>remark</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>-p ftdi:///?</code> or <code>-p</code></td>
<td>Enumerates the list of devices.</td>
</tr>
<tr class="even">
<td><code>-p [device name]</code></td>
<td>Specify the device.</td>
</tr>
<tr class="odd">
<td></td>
<td><code>ftdi:///1</code> When no other device is available.</td>
</tr>
<tr class="even">
<td></td>
<td><code>ftdi://::MW19ZZUB/1</code>Designation by serial number.</td>
</tr>
<tr class="odd">
<td><code>-b [baud]</code></td>
<td>Specify the baud rate</td>
</tr>
<tr class="even">
<td></td>
<td><code>-b 115200</code> 115200bps</td>
</tr>
<tr class="odd">
<td><code>-F [firmware bin file name]</code></td>
<td>Program the specified firmware.</td>
</tr>
<tr class="even">
<td></td>
<td><code>-F App_Twelite.bin</code> Program a file named App_Twelite.bin.</td>
</tr>
<tr class="odd">
<td><code>--no-color</code></td>
<td>Suppresses colour output of text.</td>
</tr>
<tr class="even">
<td><code>--no-term</code></td>
<td>It only programs the firmware and does not open the terminal.</td>
</tr>
</tbody>
</table>
<h3 id="keyboard-operation">keyboard operation</h3>
<p>Typing Ctrl+C will bring up a control prompt, which allows you to perform some special operations. Otherwise, the input string will be sent directly to the TWELITE radio module.</p>
<table>
<colgroup>
<col style="width: 16%"></col>
<col style="width: 83%"></col>
</colgroup>
<thead>
<tr class="header">
<th>Key sequence</th>
<th>Remark</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>Ctrl+C Ctrl+C</code></td>
<td>quit the terminal</td>
</tr>
<tr class="even">
<td><code>Ctrl+C Ctrl+R</code> または <code>Ctrl+C r</code></td>
<td>Reset TWELITE microcontroller.</td>
</tr>
<tr class="odd">
<td><code>Ctrl+C Ctrl+I</code> または <code>Ctrl+C i</code></td>
<td>Enter the <code>+ + +</code> command to enter interactive mode. Only available with firmware that supports interactive mode.</td>
</tr>
<tr class="even">
<td><code>Ctrl+C A</code></td>
<td>Start interpreting the format: for the output from the TWELITE wireless microcontroller and for the key input, the ascii format (like <code>:00112233X</code>) is interpreted.</td>
</tr>
<tr class="odd">
<td><code>Ctrl+C B</code></td>
<td>Starts interpreting the format; binary format is interpreted for the output from the TWELITE microcontroller. Key input is interpreted in ASCII format.</td>
</tr>
<tr class="even">
<td><code>Ctrl+C N</code></td>
<td>Stops interpreting the format.</td>
</tr>
</tbody>
</table>
<div class="info">
<p>During format interpretation, only messages from TWELITE that have been interpreted will be displayed, and keyboard input will be echoed back, but will be sent to TWELITE when the ASCII format has been completed.</p>
</div>
<h2 id="execution-example">[Execution example]</h2>
<p>In the example, line breaks are inserted as appropriate.</p>
<div class="warning">
<p>If you get an error, it may be a problem with the permissions on the serial port, run it with root privileges (e.g. <code>sudo</code>).</p>
</div>
<h4 id="make-sure-your-device-is-listed-first.">Make sure your device is listed first.</h4>
<div class="sourceCode" id="cb13"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb13-1" title="1">$ <span class="ex">tweterm.py</span> -p ftdi:///?</a>
<a class="sourceLine" id="cb13-2" title="2"><span class="ex">Available</span> interfaces:</a>
<a class="sourceLine" id="cb13-3" title="3">  <span class="ex">ftdi</span>://ftdi:232:MW19ZZUB/1   (MONOSTICK)</a>
<a class="sourceLine" id="cb13-4" title="4">  <span class="ex">Please</span> specify the USB device</a></code></pre></div>
<h4 id="program-the-firmware-and-start-the-terminal">Program the firmware and start the terminal</h4>
<p>The following example writes App_UART (UART communication app) and checks the boot message.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb14-1" title="1">$ <span class="ex">tweterm.py</span> -p ftdi://ftdi:232:MW19ZZUB/1 -b 115200 -F ../App_Uart_Master_RED_L1101_V1-2-15.bin </a>
<a class="sourceLine" id="cb14-2" title="2"><span class="ex">***</span> TWE Wrting firmware ... ../App_Uart_Master_RED_L1101_V1-2-15.bin</a>
<a class="sourceLine" id="cb14-3" title="3"><span class="ex">MODEL</span>: TWEModel.TWELite</a>
<a class="sourceLine" id="cb14-4" title="4"><span class="ex">SER</span>: 102eebd</a>
<a class="sourceLine" id="cb14-5" title="5"></a>
<a class="sourceLine" id="cb14-6" title="6"> <span class="fu">file</span> info: 0f 03 000b</a>
<a class="sourceLine" id="cb14-7" title="7"><span class="ex">erasing</span> sect <span class="co">#0..#1..#2..</span></a>
<a class="sourceLine" id="cb14-8" title="8"><span class="ex">0%..10%..20%..30%..40%..50%..60%..70%..80%..90%..done</span> - 10.24 kb/s</a>
<a class="sourceLine" id="cb14-9" title="9"><span class="ex">Entering</span> minicom mode</a>
<a class="sourceLine" id="cb14-10" title="10"></a>
<a class="sourceLine" id="cb14-11" title="11">!<span class="ex">INF</span> TWE UART APP V1-02-15, SID=0x8102EEBD, LID=0x78</a>
<a class="sourceLine" id="cb14-12" title="12"><span class="ex">8102EEBD</span>:<span class="op">0&gt;</span> </a></code></pre></div>
<h4 id="typing-ctrlc-will-bring-up-a-control-prompt">Typing Ctrl+C will bring up a control prompt</h4>
<pre><code>*** r:reset i:+++ A:ASCFMT B:BINFMT x:exit&gt;</code></pre>
<h4 id="then-enter-i.-you-are-now-in-interactive-mode">Then enter i. You are now in interactive mode</h4>
<pre><code>*** r:reset i:+++ A:ASCFMT B:BINFMT x:exit&gt;[+ + +]
--- CONFIG/TWE UART APP V1-02-15/SID=0x8102eebd/LID=0x00 -E ---
 a: set Application ID (0x67720103) 
 i: set Device ID (121=0x79) 
... ＜省略＞ </code></pre>
<p>If you type <code>+ + +</code> three times as usual operation, you will get the same result.</p>
<h4 id="example-of-format-interpretation-set-app_uart-to-binary-format">Example of format interpretation: Set App_UART to binary format</h4>
<p>In interactive mode, type <code>m</code> <code>B</code> <code>Enter</code> <code>S</code> in that order.</p>
<pre><code>--- CONFIG/TWE UART APP V1-02-15/SID=0x8102eebd/LID=0x00 -E ---
 a: set Application ID (0x67720103) 
 i: set Device ID (121=0x79) 
 c: set Channels (18) 
 x: set RF Conf (3) 
 r: set Role (0x0) 
 l: set Layer (0x1) 
 b: set UART baud (38400) 
 B: set UART option (8N1) 
 m: set UART mode (B)*
 h: set handle name [sadkasldja] 
 C: set crypt mode (0) 
 o: set option bits (0x00000000) 
---
 S: save Configuration
 R: reset to Defaults
 
!INF Write config Success
!INF RESET SYSTEM...</code></pre>
<h4 id="examples-of-format-interpretation">Examples of format interpretation</h4>
<p>In the following example, App_UART does input and output in binary format. Input <code>Ctrl+C</code> <code>B</code>.</p>
<pre><code>*** r:reset i:+++ A:ASCFMT B:BINFMT x:exit&gt;
[FMT: console ASCII, serial BINARY]</code></pre>
<p>In this state, input and output is in format. Keyboard input is interpreted as ASCII (input is converted to binary and sent to the TWELITE) and messages from the TWELITE as binary.</p>
<p>Here is an example of receiving a message from TWELITE. The easiest way to do this is to reset the TWELITE. Type <code>Ctrl+C</code> <code>r</code>.</p>
<pre><code>*** r:reset i:+++ A:ASCFMT B:BINFMT x:exit&gt;[RESET TWE]
[dbf1677201030001020f008102eebd0000]</code></pre>
<p>The output <code>[dbf...]</code> is the message from TWELITE, which is actually 0xdb 0xf1 0x67… which is actually a binary sequence.</p>
<p>Conversely, to send a message to TWELITE, enter it in ASCII format. Type <code>:7800112233AABBCCDDX</code>. This sends the data with a payload of 0x7800112233AABBCCDD to TWELITE in binary format. Immediately afterwards, <code>[dba18001]</code> is returned as the response.</p>
<pre><code>:7800112233AABBCCDDX[dba18001]</code></pre>
<h4 id="quitting">Quitting</h4>
<p>Input <code>Ctrl+C Ctrl+C</code>to quit terminal.</p>
<pre><code>*** r:reset i:+++ A:ASCFMT B:BINFMT x:exit&gt;[
[EXIT]
Bye.</code></pre>
</body>
</html>
